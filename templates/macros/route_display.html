{% block content %}
<div class="route-page">
    <div class="route-header">
        <h1 class="route-title">{{ route.name }}</h1>
        <label style="margin-left: 1em; font-weight: normal;">
            <input type="checkbox" id="toggle-siteswap-x-checkbox" onchange="toggleAllSiteswapX()"> Show Siteswap-X for all
        </label>
    </div>

    <div class="route-container">
        <div class="route-content">
            <div class="route-sections">
                {% set trick_counter = namespace(count=0) %}
                {% set current_props = namespace(count=none) %}
                {% for trick in route.tricks %}
                    {% if current_props.count != trick.props_count %}
                        {% if not loop.first %}
                            </div>
                        </div>
                        {% endif %}
                        <div class="prop-section">
                            <div class="prop-color-bar" data-props="{{ trick.props_count }}" data-prop-type="{{ route.prop }}">
                                <div class="prop-count">
                                    <div class="prop-count-text">X {{ trick.props_count }}</div>
                                </div>
                            </div>
                            <div class="trick-container">
                        {% set current_props.count = trick.props_count %}
                    {% endif %}
                    {% set trick_counter.count = trick_counter.count + 1 %}
                    <div class="prop-details-frame">
                        <div class="trick-content">
                            <div class="trick-main">
                                <span class="trick-number">{{ trick_counter.count }}.</span>
                                    <span class="trick-name" id="trick-name-{{ trick_counter.count }}">{{ trick.name }}</span>
                                    <span class="trick-siteswap-x" id="trick-siteswap-x-{{ trick_counter.count }}" style="display:none;">{{ trick.siteswap_x }}</span>
                                    {% if trick.comment %}
                                        <span class="trick-comment">[{{ trick.comment }}]</span>
                                    {% endif %}
                            </div>
                        </div>
                    </div>
                    {% if loop.last %}
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            <script>
            function toggleAllSiteswapX() {
                var checked = document.getElementById('toggle-siteswap-x-checkbox').checked;
                var trickNames = document.querySelectorAll('.trick-name');
                var siteswapXs = document.querySelectorAll('.trick-siteswap-x');
                for (var i = 0; i < trickNames.length; i++) {
                    var hasName = trickNames[i].textContent.trim() !== '';
                    var siteswapText = siteswapXs[i].textContent.trim();
                    var hasSiteswap = siteswapText !== '' && siteswapText.toLowerCase() !== 'none';
                    if (checked && hasSiteswap) {
                        trickNames[i].style.display = 'none';
                        siteswapXs[i].style.display = '';
                    } else {
                        trickNames[i].style.display = '';
                        siteswapXs[i].style.display = 'none';
                    }
                }
            }
            </script>
        </div>
    </div>
</div>
{% endblock %}
